<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Wi-Fi Connection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }
        .shake-animation {
            animation: shake 0.2s ease-in-out infinite;
        }
        .gradient-bg {
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }
        #full-screen-reveal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 100;
            background: black;
        }
        /* Ensure the image takes up the full screen correctly */
        #gorillaImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<body class="gradient-bg h-screen flex flex-col items-center justify-center text-white font-sans overflow-hidden">

    <!-- Loading Screen -->
    <div id="loader-container" class="w-full max-w-md p-8 transition-opacity duration-1000 ease-in-out">
        <div class="flex justify-center mb-10">
            <svg class="w-20 h-20 text-blue-500 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"></path>
            </svg>
        </div>
        
        <h1 id="statusText" class="text-2xl font-bold mb-8 text-center text-gray-200 h-16 transition-all">
            Connecting to Network...
        </h1>

        <div id="progress-wrapper" class="w-full bg-gray-900 h-5 rounded-full overflow-hidden border border-gray-700 shadow-2xl">
            <div id="progressBar" class="h-full bg-gradient-to-r from-blue-500 via-cyan-400 to-green-400 w-0 transition-all duration-100 linear"></div>
        </div>
        
        <p id="percentageText" class="mt-6 text-center text-gray-500 font-mono text-lg">0%</p>
    </div>

    <!-- The Full Screen Prank Reveal -->
    <div id="full-screen-reveal" class="flex flex-col items-center justify-center">
        <img 
            id="gorillaImage"
            src="image.png" 
            alt="Gotcha!"
        >
        <!-- Bottom Message: Responsive and Styled -->
        <div class="absolute bottom-6 md:bottom-12 left-0 right-0 px-4 flex justify-center pointer-events-none">
            <div class="bg-black/80 px-6 py-4 md:px-12 md:py-6 rounded-xl md:rounded-2xl border-2 md:border-4 border-red-600 backdrop-blur-lg shadow-[0_0_50px_rgba(220,38,38,0.5)] w-full max-w-[90%] md:max-w-2xl">
                <h2 class="text-3xl md:text-6xl font-black text-red-500 uppercase italic tracking-tighter text-center leading-tight">
                    FREE WI-FI? <br>
                    <span class="text-white text-xl md:text-3xl not-italic font-bold">Keep dreaming, cheapskate!</span>
                </h2>
            </div>
        </div>
    </div>

    <!-- Audio from repo -->
    <audio id="revealSound" src="reveal.mp3" preload="auto"></audio>

    <script>
        const progressBar = document.getElementById("progressBar");
        const statusText = document.getElementById("statusText");
        const percentageText = document.getElementById("percentageText");
        const loaderContainer = document.getElementById("loader-container");
        const progressWrapper = document.getElementById("progress-wrapper");
        const fullScreenReveal = document.getElementById("full-screen-reveal");
        const revealSound = document.getElementById("revealSound");

        let percent = 0;
        let isGlitching = false;
        let audioUnlocked = false;

        // Milestones for text updates
        const messages = [
            { p: 15, t: "Identifying local gateway..." },
            { p: 35, t: "Initializing security handshake..." },
            { p: 60, t: "Optimizing bandwidth allocation..." },
            { p: 80, t: "Verifying network protocols..." }
        ];

        // Critical: Unlock audio on any user interaction during loading
        // Browsers block audio until the user clicks somewhere.
        function unlockAudio() {
            if (!audioUnlocked) {
                revealSound.play().then(() => {
                    revealSound.pause();
                    revealSound.currentTime = 0;
                    audioUnlocked = true;
                }).catch(() => {});
            }
        }

        window.addEventListener('mousedown', unlockAudio);
        window.addEventListener('touchstart', unlockAudio);

        function triggerPrankSequence() {
            // Start audio immediately
            revealSound.play().catch(e => {
                console.warn("Audio blocked. Pranks work best if the user clicks the page once while loading.");
            });
            
            // Fade out the loader slowly (per user request: no "CONNECTED" text)
            loaderContainer.classList.add("opacity-0");
            
            // Wait 4 seconds for the image reveal
            setTimeout(() => {
                fullScreenReveal.style.display = 'flex';
                
                // Blast Confetti
                const duration = 4 * 1000;
                const end = Date.now() + duration;

                (function frame() {
                    confetti({
                        particleCount: 5,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: ['#ff0000', '#ffffff', '#000000']
                    });
                    confetti({
                        particleCount: 5,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: ['#ff0000', '#ffffff', '#000000']
                    });

                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                }());
            }, 4000); 
        }

        function runLoader() {
            const timer = setInterval(() => {
                // The 92% Glitch
                if (percent === 92 && !isGlitching) {
                    isGlitching = true;
                    statusText.textContent = "SIGNAL UNSTABLE...";
                    statusText.classList.add("text-red-500");
                    progressWrapper.classList.add("shake-animation");
                    
                    setTimeout(() => {
                        progressWrapper.classList.remove("shake-animation");
                        statusText.classList.remove("text-red-500");
                        statusText.textContent = "Signal restored! Finalizing...";
                        percent++; 
                        isGlitching = false;
                    }, 1500);
                    return;
                }

                if (isGlitching) return;

                percent++;
                progressBar.style.width = percent + "%";
                percentageText.textContent = percent + "%";

                const msg = messages.find(m => m.p === percent);
                if (msg) statusText.textContent = msg.t;

                if (percent >= 100) {
                    clearInterval(timer);
                    // Instead of showing "CONNECTED", we trigger the sequence
                    triggerPrankSequence();
                }
            }, 80); 
        }

        // Auto-start as requested
        window.onload = runLoader;
    </script>
</body>
</html>
